// ------------------ Ø¯ÛŒØªØ§Ø¨ÛŒØ³ Ø¯Ø³ØªÛŒ Ùˆ ØªÙ†Ø¸ÛŒÙ…Ø§Øª ------------------
const botToken = "8119661357:AAERf2mm-u2GN5COlPUQ5M57RiQ5YMC499E";
const ownerId = 7167880893;
const premiumLink = "https://t.me/yourpremiumchannel";
const fs = require('fs');  // Ø¨Ø±Ø§ÛŒ Ú©Ø§Ø± Ø¨Ø§ ÙØ§ÛŒÙ„â€ŒÙ‡Ø§
// Ù„ÛŒØ³Øª Ú©Ø§Ø±Ø¨Ø±Ø§Ù†
// Ù„ÛŒØ³Øª Ú©Ø§Ø±Ø¨Ø±Ø§Ù† Ø§Ø² ÙØ§ÛŒÙ„ Ù…ØªÙ†ÛŒ Ø¨Ø§Ø±Ú¯Ø²Ø§Ø±ÛŒ Ù…ÛŒØ´Ù‡
let users = [];

fs.readFile('users.txt', 'utf8', (err, data) => {
  if (err) {
    console.log("Ù‡ÛŒÚ† Ú©Ø§Ø±Ø¨Ø±ÛŒ Ø«Ø¨Øª Ù†Ø´Ø¯Ù‡");
  } else {
    users = data.split("\n");  // Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ø±Ùˆ Ø§Ø² ÙØ§ÛŒÙ„ Ù…ÛŒâ€ŒØ®ÙˆØ§Ù†ÛŒÙ… Ùˆ Ø¨Ù‡ Ø¢Ø±Ø§ÛŒÙ‡ ØªÙ‚Ø³ÛŒÙ… Ù…ÛŒâ€ŒÚ©Ù†ÛŒÙ…
  }
});
// ------------------------------------------------------------

// ÙˆØ§Ø±Ø¯ Ú©Ø±Ø¯Ù† Ù¾Ú©ÛŒØ¬
const TelegramBot = require("node-telegram-bot-api");

// ØªØ¹Ø±ÛŒÙ Ø±Ø¨Ø§Øª
const bot = new TelegramBot(botToken, { polling: true });

// ------------------ Ø¯Ø³ØªÙˆØ± /start ------------------
bot.onText(/\/start/, (msg) => {
  const chatId = msg.chat.id;

  // Ø«Ø¨Øª Ú©Ø§Ø±Ø¨Ø± Ø¯Ø± Ø¯ÛŒØªØ§Ø¨ÛŒØ³ Ø¯Ø³ØªÛŒ
if (!users.includes(chatId)) {
  users.push(chatId);
  console.log("Ú©Ø§Ø±Ø¨Ø± Ø¬Ø¯ÛŒØ¯ Ø«Ø¨Øª Ø´Ø¯:", chatId);
  console.log("Ù„ÛŒØ³Øª ÙØ¹Ù„ÛŒ:", users);
}
// Ø°Ø®ÛŒØ±Ù‡ Ú©Ø§Ø±Ø¨Ø±Ø§Ù† Ø¯Ø± ÙØ§ÛŒÙ„ Ù…ØªÙ†ÛŒ
fs.writeFile('users.txt', users.join("\n"), (err) => {
  if (err) {
    console.log("Ø®Ø·Ø§ Ø¯Ø± Ø°Ø®ÛŒØ±Ù‡ ÙØ§ÛŒÙ„:", err);
  } else {
    console.log("Ú©Ø§Ø±Ø¨Ø± Ø¬Ø¯ÛŒØ¯ Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯:", chatId);
  }
});
  // Ù¾ÛŒØ§Ù… Ø®ÙˆØ´â€ŒØ¢Ù…Ø¯Ú¯ÙˆÛŒÛŒ + Ú©ÛŒØ¨ÙˆØ±Ø¯
  bot.sendMessage(chatId, "Ø³Ù„Ø§Ù… Ø®ÙˆØ´ Ø§ÙˆÙ…Ø¯ÛŒØ¯. Ù„Ø·ÙØ§ ÛŒÚ©ÛŒ Ø§Ø² Ú¯Ø²ÛŒÙ†Ù‡ Ù‡Ø§Ø±Ùˆ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯", {
    reply_markup: {
      keyboard: [
        ["Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒÛŒ Ø®Ø±ÛŒØ¯", "ðŸ’° Ø®Ø±ÛŒØ¯ Ø§Ø´ØªØ±Ø§Ú©"],
        ["ðŸ“ž ØªÙ…Ø§Ø³ Ø¨Ø§ Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ"]
      ],
      resize_keyboard: true,
      one_time_keyboard: true
    }
  });
});

// ------------------ ÙˆØ§Ú©Ù†Ø´ Ø¨Ù‡ Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ ------------------
bot.on("message", (msg) => {
  const chatId = msg.chat.id;
  const text = msg.text;

  if (text === "Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒÛŒ Ø®Ø±ÛŒØ¯") {
    bot.sendMessage(chatId, "Ø¬Ù‡Øª Ø®Ø±ÛŒØ¯ Ø§Ø´ØªØ±Ø§Ú© Ø¨Ø± Ø±ÙˆÛŒ Ú¯Ø²ÛŒÙ†Ù‡ Ø®Ø±ÛŒØ¯ Ø§Ø´ØªØ±Ø§Ú© Ø²Ø¯Ù‡ Ùˆ Ø³Ù¾Ø³ Ø¯Ø³ØªÙˆØ±â€ŒØ§Ù„Ø¹Ù…Ù„ Ù‡Ø§Ø±Ø§ Ø¯Ù†Ø¨Ø§Ù„ Ú©Ù†ÛŒØ¯.");
  }

  if (text === "ðŸ’° Ø®Ø±ÛŒØ¯ Ø§Ø´ØªØ±Ø§Ú©") {
    bot.sendMessage(chatId, `Ù„ÛŒÙ†Ú© Ø¯Ø±Ú¯Ø§Ù‡:\nØ¬Ø§ÛŒÚ¯Ø§Ù‡ Ø¯Ø±Ú¯Ø§Ù‡ Ù¾Ø±Ø¯Ø§Ø®Øª`);
  }

  if (text === "ðŸ“ž ØªÙ…Ø§Ø³ Ø¨Ø§ Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ") {
    bot.sendMessage(chatId, "Ø¬Ù‡Øª Ø§Ø±ØªØ¨Ø§Ø· Ø¨Ø§ Ø¨Ø±Ù†Ø§Ù…Ù‡ Ù†ÙˆÛŒØ³ Ø¨Ù‡ Ø¢ÛŒØ¯ÛŒ Ø¯ÙˆÙ„ÙˆÙ¾Ø± Ù¾ÛŒØ§Ù… Ø¯Ù‡ÛŒØ¯:\n@Shahrad13s");
  }
});
// Ø¯Ø³ØªÙˆØ± /list Ø¨Ø±Ø§ÛŒ Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ù‡Ù…Ù‡ Ú©Ø§Ø±Ø¨Ø±Ø§
bot.onText(/\/list/, (msg) => {
  const chatId = msg.chat.id;
  
  // Ú†Ú© Ù…ÛŒÚ©Ù†ÛŒÙ… Ú©Ù‡ ÙÙ‚Ø· Ø§Ø¯Ù…ÛŒÙ† (ØªÙˆ) Ø§ÛŒÙ† Ø¯Ø³ØªÙˆØ± Ø±Ùˆ Ø¨Ø²Ù†Ù‡
  if (chatId === ownerId) {
    bot.sendMessage(chatId, "Ù„ÛŒØ³Øª Ú©Ø§Ø±Ø¨Ø±Ø§:\n" + users.join("\n"));
  } else {
    bot.sendMessage(chatId, "Ø´Ù…Ø§ Ø¯Ø³ØªØ±Ø³ÛŒ Ø¨Ù‡ Ø§ÛŒÙ† Ø¯Ø³ØªÙˆØ± Ù†Ø¯Ø§Ø±ÛŒØ¯.");
  }
});
// Ø¯Ø³ØªÙˆØ± /broadcast Ø¨Ø±Ø§ÛŒ Ø§Ø±Ø³Ø§Ù„ Ù¾ÛŒØ§Ù… Ø¨Ù‡ Ù‡Ù…Ù‡ Ú©Ø§Ø±Ø¨Ø±Ø§Ù†
bot.onText(/\/broadcast (.+)/, (msg, match) => {
  const chatId = msg.chat.id;
  const text = match[1];  // Ù¾ÛŒØ§Ù…ÛŒ Ú©Ù‡ Ø§Ø¯Ù…ÛŒÙ† ÙˆØ§Ø±Ø¯ Ù…ÛŒâ€ŒÚ©Ù†Ù‡

  // Ú†Ú© Ù…ÛŒÚ©Ù†ÛŒÙ… Ú©Ù‡ ÙÙ‚Ø· Ø§Ø¯Ù…ÛŒÙ† Ø§ÛŒÙ† Ø¯Ø³ØªÙˆØ± Ø±Ùˆ Ø¨Ø²Ù†Ù‡
  if (chatId === ownerId) {
    // Ø§Ø±Ø³Ø§Ù„ Ù¾ÛŒØ§Ù… Ø¨Ù‡ ØªÙ…Ø§Ù… Ú©Ø§Ø±Ø¨Ø±Ø§Ù†
    users.forEach((userId) => {
      bot.sendMessage(userId, text);
    });

    // ØªØ§ÛŒÛŒØ¯ Ø§Ø±Ø³Ø§Ù„ Ù¾ÛŒØ§Ù…
    bot.sendMessage(chatId, "Ù¾ÛŒØ§Ù… Ø³Ø±Ø§Ø³Ø±ÛŒ Ø¨Ù‡ Ù‡Ù…Ù‡ Ú©Ø§Ø±Ø¨Ø±Ø§Ù† Ø§Ø±Ø³Ø§Ù„ Ø´Ø¯!");
  } else {
    bot.sendMessage(chatId, "Ø´Ù…Ø§ Ø¯Ø³ØªØ±Ø³ÛŒ Ø¨Ù‡ Ø§ÛŒÙ† Ø¯Ø³ØªÙˆØ± Ù†Ø¯Ø§Ø±ÛŒØ¯.");
  }
});
